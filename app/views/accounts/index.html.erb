<div class="container mt-4">
  <div class="row">

    <!-- Posts Section -->
    <div class="col-md-8 order-2 order-md-1">
      <% @posts.each do |post| %>
        <div class="post bg-white p-3 mb-4 border rounded shadow-sm" id="post-<%= post.id %>">
          
          <!-- Post Header -->
          <div class="post-header d-flex align-items-center mb-2">
            <%= image_tag(
              post.account.image.attached? ? url_for(post.account.image) : "default.png",
              style: "width:40px; height:40px; border-radius:50%; object-fit:cover;",
              alt: "#{post.account.username}'s profile image",
              class: "me-2"
            ) %>

            <%= link_to post.account.username, show_path(post.account.username), class: "text-dark fw-bold" %>
          </div>

          <!-- Post Image -->
          <div class="post-image mb-2" style="width: 100%; height: 400px; border-radius: 8px; overflow: hidden; background:#000;">
            <% if post.image.attached? %>
              <%= image_tag url_for(post.image),
                    style: "width: 100%; height: 100%; object-fit: contain;",
                    alt: "Post image" %>
            <% end %>
          </div>

          <!-- Like Button -->
          <div class="like-button d-flex align-items-center mb-2">
            <%= render "posts/like_button", post: post %>
          </div>

          <!-- Post Description -->
          <div class="post-description mb-2">
            <p class="mb-1">
              <%= link_to post.account.username, show_path(post.account.username), class: "text-dark fw-bold" %>
              <%= simple_format post.description %>
            </p>
            <p class="text-muted small"><%= time_ago_in_words post.created_at %> ago</p>
          </div>

          <!-- Comments -->
          <h6 class="fw-bold">Comments</h6>
          <div id="comments_<%= post.id %>" style="max-height: 200px; overflow-y: auto; border: 1px solid #ddd; border-radius: 6px; padding: 8px;">
            <%= render "comments/form", post: post %>
          </div>
        </div>
      <% end %>
    </div>

    <!-- Sidebar -->
    <div class="col-md-4 order-1 order-md-2">

      <!-- Account Info -->
      <div class="account-info bg-white p-3 mb-4 border rounded shadow-sm">
        <div class="d-flex align-items-center">
          <%= image_tag(
            current_account.image.attached? ? url_for(current_account.image) : "default.png",
            style: "width:50px; height:50px; border-radius:50%; object-fit:cover;",
            alt: "#{current_account.username}'s profile image",
            class: "me-2"
          ) %>
          <div>
            <%= link_to current_account.username, show_path(current_account.username), class: "text-dark fw-bold" %>
            <p class="text-muted small mb-0"><%= current_account.full_name %></p>
          </div>
        </div>
      </div>

      <!-- Suggestions -->
      <div class="follower-suggestion bg-white p-3 border rounded shadow-sm overflow-scroll">
        <div class="d-flex justify-content-between align-items-center mb-2 ">
          <p class="mb-0 fw-bold">Suggestions for you</p>
          <%= link_to "View All", "#", class: "text-dark small" %>
        </div>

        <% if @accounts.any? %>
          <% @accounts.each do |account| %>
            <div id="suggestion_<%= account.id %>" class="suggestion d-flex align-items-center mb-3">
              <%= image_tag(
                account.image.attached? ? url_for(account.image) : "default.png",
                style: "width:40px; height:40px; border-radius:50%; object-fit:cover;",
                alt: "#{account.username}'s profile image",
                class: "me-2"
              ) %>

              <div class="d-flex justify-content-between align-items-center w-100">
                <%= link_to account.username, show_path(account.username), class: "text-dark fw-bold" %>
                <%= render "accounts/follow_button", account: account %>
              </div>
            </div>
          <% end %>
        <% else %>
          <p class="text-muted small">No suggestions available.</p>
        <% end %>
      </div>

    </div>
  </div>
</div> 