<div class="container mt-4">
  <div class="row">

    <!-- Posts Section -->
    <div class="col-md-8 order-2 order-md-1">
      <% @posts.each do |post| %>
        <div class="post bg-white p-3 mb-4 border rounded shadow-sm" id="post-<%= post.id %>">

          <!-- Post Header -->
          <div class="post-header d-flex align-items-center mb-2">
            <%= image_tag(
              post.account.image.attached? ? url_for(post.account.image) : "default.png",
              style: "width:40px; height:40px; border-radius:50%; object-fit:cover;",
              alt: "#{post.account.username}'s profile image",
              class: "me-2"
            ) %>
            <%= link_to post.account.username, show_path(post.account.username), class: "text-dark fw-bold" %>
          </div>

          <!-- Post Image with Hover Effect -->
          <div class=" post-image mb-2"style="width: 100%; height: 400px; border-radius: 8px; overflow: hidden;">
            <% if post.image.attached? %>
              <%= image_tag url_for(post.image),
                        class: "w-100 h-100 post-img-hover",
                    style: "width: 100%; height: 100%; object-fit: contain; background: #000000ff;",
                    alt: "Post image" %>
            <% end %>
          </div>

          <!-- Like & Comment Buttons -->
          <div class="d-flex align-items-center mb-2 gap-3">
            <%= render "posts/like_button", post: post %>
            <%= link_to "Comment", "#comments_#{post.id}", class: "text-muted small" %>
          </div>

          <!-- Post Description -->
          <div class="post-description mb-2">
            <p class="mb-1">
              <%= link_to post.account.username, show_path(post.account.username), class: "text-dark fw-bold" %>
              <%= simple_format post.description %>
            </p>
            <p class="text-muted small"><%= time_ago_in_words post.created_at %> ago</p>
          </div>

          <!-- Comments Section -->
        <div id="comments_<%= post.id %>" class="comments-box mb-2 p-2 border rounded" style="max-height:200px; overflow-y:auto;">
            <%= render "comments/form", post: post %>
          </div>

        </div>
      <% end %>
    </div>

    <!-- Sidebar -->
    <div class="col-md-4 order-1 order-md-2">

      <!-- Account Info -->
      <div class="account-info bg-white p-3 mb-4 border rounded shadow-sm d-flex align-items-center gap-2">
        <%= image_tag(
          current_account.image.attached? ? url_for(current_account.image) : "default.png",
          style: "width:50px; height:50px; border-radius:50%; object-fit:cover;"
        ) %>
        <div>
          <%= link_to current_account.username, show_path(current_account.username), class: "text-dark fw-bold" %>
          <p class="text-muted small mb-0"><%= current_account.full_name %></p>
        </div>
      </div>

      <!-- Suggestions -->
      <div class="follower-suggestion bg-white p-3 border rounded shadow-sm" style="max-height:400px; overflow-y:auto;">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <p class="mb-0 fw-bold">Suggestions for you</p>
          <%= link_to "View All", "#", class: "text-dark small" %>
        </div>

        <% if @accounts.any? %>
          <% @accounts.each do |account| %>
            <div id="suggestion_<%= account.id %>" class="suggestion d-flex align-items-center mb-3 p-1 rounded hover-bg">
              <%= image_tag(
                account.image.attached? ? url_for(account.image) : "default.png",
                style: "width:40px; height:40px; border-radius:50%; object-fit:cover;",
                class: "me-2"
              ) %>
              <div class="d-flex justify-content-between align-items-center w-100">
                <%= link_to account.username, show_path(account.username), class: "text-dark fw-bold" %>
                <%= render "accounts/follow_button", account: account %>
              </div>
            </div>
          <% end %>
        <% else %>
          <p class="text-muted small">No suggestions available.</p>
        <% end %>
      </div>

    </div>
  </div>
</div>

<!-- Extra CSS for hover effects -->
<style>
.post-img-hover {
  transition: transform 0.3s ease;
}
.post-img-hover:hover {
  transform: scale(1.05);
}
.hover-bg:hover {
  background-color: #f5f5f5;
}
</style>
